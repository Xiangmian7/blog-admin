import"./base-1063101c.js";import{E as $}from"./el-overlay-bca17219.js";import{E as H,a as R}from"./el-form-item-ce17aa6e.js";import{E as q,a as p,b as P}from"./index-24d76c80.js";import{E as j,a as D,f as k,b as G,c as J}from"./format-355ef022.js";import"./el-scrollbar-ccdd61e3.js";import"./el-checkbox-462180b5.js";import{d as K,g as y,q as O,v as Q,o as v,a as A,i as w,k as e,w as o,b as g,f as W,x as i,F as X,h as Y,y as Z,t as C,s as h,_ as ee}from"./index-24cafc78.js";import{u as te}from"./article-a0650abc.js";import"./index-4df2dc72.js";const le={class:"articleManage"},ae={class:"new-article"},oe={class:"pagination"},se=K({__name:"article-manage",setup(ne){const E=W(),d=y(!1),u=y(0),r=te(),t=O({title:"",classify:"",labels:"",description:""}),b=y();r.getArticleListAction(u.value,10);const{articleList:x,totalCount:I}=Q(r);function B(s){r.deleteArticleAction(s).then(()=>{r.getArticleListAction(u.value,10),p({message:"删除文章成功~",type:"success"})},()=>{p.error("删除文章失败~")})}function L(s){u.value=(s-1)*10,r.getArticleListAction(u.value,10)}function V(s){if(s){d.value=!0;for(const n in t)t[n]=s[n];let l="";for(let n of s.labels)l=l+"/"+n.name;l=l.slice(1),t.labels=l,b.value=s.id}else for(const l in t)t[l]=""}function T(){if(t.title&&t.classify&&t.labels&&t.description){const s=t.labels.split("/"),l=b.value,n={title:t.title,classify:t.classify,description:t.description,labels:s};r.updateArticleBaseInfoAction(n,l).then(()=>{p({message:"更新数据成功~",type:"success"}),d.value=!1,r.getArticleListAction(u.value,10)},()=>{p.error("更新数据失败~")})}else p.error("数据不能为空~")}function U(){const s=b.value;r.getArticleDetailAction(s).then(()=>{h.setCache("page","/main/postArticle"),h.setCache("activeIndex","1"),E.push("/main/postArticle")})}return(s,l)=>{const n=q,c=G,z=J,F=j,M=D,m=P,f=H,N=R,S=$;return v(),A("div",le,[w("div",ae,[e(n,{type:"primary",onClick:V},{default:o(()=>[i("新建文章")]),_:1})]),e(F,{data:g(x),style:{width:"100%"},border:""},{default:o(()=>[e(c,{prop:"id",label:"id",width:60}),e(c,{prop:"title",label:"标题"}),e(c,{prop:"classify",label:"分类",width:70}),e(c,{label:"标签",width:140},{default:o(a=>[(v(!0),A(X,null,Y(a.row.labels,_=>(v(),Z(z,{key:_.id},{default:o(()=>[i(C(_.name),1)]),_:2},1024))),128))]),_:1}),e(c,{prop:"description",label:"描述"}),e(c,{label:"创建时间",width:170},{default:o(a=>[i(C(g(k)(a.row.createAt)),1)]),_:1}),e(c,{label:"创建时间",width:170},{default:o(a=>[i(C(g(k)(a.row.updateAt)),1)]),_:1}),e(c,{label:"操作",width:130},{default:o(a=>[e(n,{size:"small",type:"primary",text:"",onClick:_=>V(a.row)},{default:o(()=>[i("编辑")]),_:2},1032,["onClick"]),e(n,{size:"small",type:"danger",text:"",onClick:_=>B(a.row.id)},{default:o(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),w("div",oe,[e(M,{"page-size":10,background:"",layout:"total, prev, pager, next",total:g(I),onCurrentChange:L},null,8,["total"])]),e(S,{modelValue:d.value,"onUpdate:modelValue":l[5]||(l[5]=a=>d.value=a),"align-center":"",center:"",title:"修改文章基本信息",width:"42%"},{footer:o(()=>[e(n,{onClick:l[4]||(l[4]=a=>d.value=!1)},{default:o(()=>[i("取消")]),_:1}),e(n,{type:"primary",onClick:T},{default:o(()=>[i(" 确定 ")]),_:1}),e(n,{type:"success",onClick:U},{default:o(()=>[i(" 修改内容 ")]),_:1})]),default:o(()=>[e(N,{size:"large",model:t},{default:o(()=>[e(f,{label:"标题"},{default:o(()=>[e(m,{modelValue:t.title,"onUpdate:modelValue":l[0]||(l[0]=a=>t.title=a),placeholder:"标题..."},null,8,["modelValue"])]),_:1}),e(f,{label:"分类"},{default:o(()=>[e(m,{modelValue:t.classify,"onUpdate:modelValue":l[1]||(l[1]=a=>t.classify=a),placeholder:"开发 随笔"},null,8,["modelValue"])]),_:1}),e(f,{label:"标签"},{default:o(()=>[e(m,{modelValue:t.labels,"onUpdate:modelValue":l[2]||(l[2]=a=>t.labels=a),placeholder:"请将要添加的标签以/隔开"},null,8,["modelValue"])]),_:1}),e(f,{label:"描述"},{default:o(()=>[e(m,{type:"textarea",rows:5,placeholder:"描述...",modelValue:t.description,"onUpdate:modelValue":l[3]||(l[3]=a=>t.description=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const be=ee(se,[["__scopeId","data-v-7e1494fc"]]);export{be as default};
