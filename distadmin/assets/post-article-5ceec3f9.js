import"./base-1063101c.js";import{a as F,E as N}from"./el-form-item-ce17aa6e.js";import{a9 as h,a as n,E as g,b as U}from"./index-24d76c80.js";import{u as x}from"./article-a0650abc.js";import{d as C,v as E,g as k,E as w,l as B,o as b,a as V,k as t,i as I,w as r,F as z,m as T,x as A,_ as S,q as $,b as v,t as D,A as q,p as j,j as H}from"./index-24cafc78.js";import"./index-4df2dc72.js";const M={class:"btn"},O=C({__name:"my-editor",props:["articleId"],setup(d){const u=d,c=x(),{articleContent:e}=E(c),s=k("");w(()=>{s.value=e.value,setTimeout(()=>{stop()},5e3)});const _="Bearer "+B.getCache("token"),f=(o,l,a)=>{const p=new FormData;p.append("picture",a[0]),h.post(`/upload/picture/${u.articleId}`,p,{headers:{"Content-Type":"multipart/form-data",authorization:_}}).then(m=>{l({url:m}),n({message:"图片上传成功~",type:"success"})},()=>{n.error("图片上传失败~")})};function y(){s.value?h.request({method:"POST",url:`/article/${u.articleId}`,data:{content:s.value},headers:{authorization:_}}).then(()=>{n({message:"内容上传成功~",type:"success"}),s.value="",c.articleName="",c.articleId=0,c.articleContent=""},()=>{n.error("内容上传失败~")}):n.error("数据不能为空~")}return(o,l)=>{const a=T("v-md-editor"),p=g;return b(),V(z,null,[t(a,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=m=>s.value=m),height:"600px",placeholder:"请输入...",onUploadImage:f,"disabled-menus":[]},null,8,["modelValue"]),I("div",M,[t(p,{type:"primary",size:"large",round:"",onClick:y},{default:r(()=>[A("上传内容")]),_:1})])],64)}}});const P=S(O,[["__scopeId","data-v-b9c3bf32"]]),R=d=>(j("data-v-e3141d20"),d=d(),H(),d),G={class:"postArticle"},J=R(()=>I("span",{class:"buttonInfo"},"(必须先提交文章基本信息获取文章id)",-1)),K={key:0,class:"articleName"},L=C({__name:"post-article",setup(d){const u=x(),c=k(),e=$({title:"",description:"",classify:"",label:""});function s(){if(e.title&&e.description&&e.classify&&e.label){const y=e.label.split("/"),o={title:e.title,description:e.description,classify:e.classify,labels:y};u.postArticleBaseInfoAction(o).then(()=>{c.value.resetFields(),n({message:"提交成功~",type:"success"})},()=>{n.error("提交失败~")})}else n.error("文章基本信息不能为空~")}const{articleId:_,articleName:f}=E(u);return(y,o)=>{const l=U,a=N,p=g,m=F;return b(),V("div",G,[t(m,{model:e,size:"large",ref_key:"fromel",ref:c},{default:r(()=>[t(a,{label:"文章标题",prop:"title"},{default:r(()=>[t(l,{modelValue:e.title,"onUpdate:modelValue":o[0]||(o[0]=i=>e.title=i),placeholder:"标题..."},null,8,["modelValue"])]),_:1}),t(a,{label:"文章描述",prop:"description"},{default:r(()=>[t(l,{type:"textarea",rows:5,modelValue:e.description,"onUpdate:modelValue":o[1]||(o[1]=i=>e.description=i),placeholder:"描述..."},null,8,["modelValue"])]),_:1}),t(a,{label:"文章分类",prop:"classify"},{default:r(()=>[t(l,{modelValue:e.classify,"onUpdate:modelValue":o[2]||(o[2]=i=>e.classify=i),placeholder:"开发 随笔"},null,8,["modelValue"])]),_:1}),t(a,{label:"文章标签",prop:"label"},{default:r(()=>[t(l,{modelValue:e.label,"onUpdate:modelValue":o[3]||(o[3]=i=>e.label=i),placeholder:"请将要添加的标签以/隔开"},null,8,["modelValue"])]),_:1}),t(a,{class:"button"},{default:r(()=>[t(p,{type:"primary",size:"large",round:"",onClick:s},{default:r(()=>[A("提交")]),_:1}),J]),_:1})]),_:1},8,["model"]),v(f)?(b(),V("div",K,[I("span",null,"当前正在编辑的文章："+D(v(f)),1)])):q("",!0),t(P,{articleId:v(_)},null,8,["articleId"])])}}});const te=S(L,[["__scopeId","data-v-e3141d20"]]);export{te as default};
